<div class="card">
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
    <h2>üó∫Ô∏è Product Mappings</h2>
    <a href="/admin/mappings/new" class="btn">+ Add Mapping</a>
  </div>

  <p style="margin-bottom: 20px; color: #7f8c8d;">
    Product mappings connect Shopify products to aXcelerate class instances. When a mapped product is purchased, 
    the system will automatically enrol the customer into the corresponding aXcelerate class.
  </p>

  <% if (mappings.length === 0) { %>
    <div class="empty-state">
      <p><strong>No product mappings configured yet.</strong></p>
      <p style="margin-top: 10px;">Add your first mapping to start syncing orders.</p>
      <a href="/admin/mappings/new" class="btn" style="margin-top: 20px;">+ Add Product Mapping</a>
    </div>
  <% } else { %>
    <table>
      <thead>
        <tr>
          <th>Shopify Product ID</th>
          <th>Product Title</th>
          <th>aXcelerate Instance ID</th>
          <th>Type</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% mappings.forEach(mapping => { %>
          <tr>
            <td><code><%= mapping.shopify_product_id %></code></td>
            <td>
              <%= mapping.product_title || 'N/A' %>
              <% if (mapping.shopify_variant_id) { %>
                <br><small style="color: #7f8c8d;">Variant: <%= mapping.shopify_variant_id %></small>
              <% } %>
            </td>
            <td><code><%= mapping.axcelerate_instance_id %></code></td>
            <td><%= mapping.axcelerate_type %></td>
            <td>
              <% if (mapping.is_active) { %>
                <span class="badge success">Active</span>
              <% } else { %>
                <span class="badge skipped">Inactive</span>
              <% } %>
            </td>
            <td>
              <a href="/admin/mappings/<%= mapping.id %>/edit" class="btn btn-sm">Edit</a>
              <form action="/admin/mappings/<%= mapping.id %>/delete" method="POST" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete this mapping?');">
                <button type="submit" class="btn btn-sm btn-danger">Delete</button>
              </form>
            </td>
          </tr>
        <% }); %>
      </tbody>
    </table>
  <% } %>
</div>

<div class="card">
  <h2>‚ÑπÔ∏è How Product Mappings Work</h2>
  <ol style="padding-left: 20px;">
    <li style="margin-bottom: 10px;">
      <strong>Shopify Product ID:</strong> The unique identifier for your product in Shopify (found in the product URL or API)
    </li>
    <li style="margin-bottom: 10px;">
      <strong>aXcelerate Instance ID:</strong> The class instance ID in aXcelerate (PDataID for workshops, ClassID for programs)
    </li>
    <li style="margin-bottom: 10px;">
      <strong>Type:</strong> Usually "p" for programs/classes. See aXcelerate API docs for other types.
    </li>
    <li style="margin-bottom: 10px;">
      When an order is paid in Shopify, the system looks up the mapping and creates enrolments automatically.
    </li>
  </ol>
</div>

